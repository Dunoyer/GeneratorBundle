{% use '../CommonAdmin/generic_actions.php.twig' %}
{% use '../CommonAdmin/ShowTemplate/column.php.twig' %}

{% block show %}
{{ echo_block('show') }}
    {{ echo_block('object') }}

    {% for fieldset in builder.fieldsets|keys %}
    {% set fieldsetColumns = builder.columnsFor(fieldset) %}
    {% set fieldsetGroups = fieldsetColumns|mapBy('groups')|flatten %}

    {% if fieldsetGroups is not empty %}
    {{ echo_set('fieldsetGroups', echo_twig_arr(fieldsetGroups)) }}
    {{ echo_if('groups is empty or fieldsetGroups|intersect(groups) is not empty') }}
    {% endif %}

        <fieldset class="form_block form_fieldset_{{ fieldset|classify|replace({'.': '_'}) }} tab-pane">
            {% if "NONE" != fieldset[:4] and "!" != fieldset[:1] %}
            <legend><span>{{ echo_trans(fieldset,{}, i18n_catalog is defined ? i18n_catalog : "Admin" ) }}</span></legend>
            {% endif %}

            {% for row in builder.fieldsets[fieldset] %}
            {% set rowColumns = builder.columnsFor(row) %}
            {% set rowGroups = rowColumns|mapBy('groups')|flatten %}

            {% if rowGroups is not empty %}
            {{ echo_set('rowGroups', echo_twig_arr(rowGroups)) }}
            {{ echo_if('groups is empty or rowGroups|intersect(groups) is not empty') }}
            {% endif %}

                <div class="row">
                {% for column in rowColumns %}
                {% if column.groups is not empty %}
                {{ echo_set('columnGroups', echo_twig_arr(column.groups)) }}
                {{ echo_if('groups is empty or columnGroups|intersect(groups) is not empty') }}
                {% endif %}

                    <div class="col-md-2 text-right">
                    {{ echo_block('show_column_label_' ~ column.name) -}}
                        <strong>{{ echo_twig("'" ~ column.label|addslashes ~ "'|trans({}, '" ~ i18n_catalog|default("Admin") ~ "')") }}</strong>
                    {{- echo_endblock() }}
                    </div>

                    <div class="col-md-10">
                        <div class="form-group form_field field_{{ column.name }}">
                            {{ block('show_column') }}
                        </div>
                    </div>
                {% if column.groups is not empty %}
                {{ echo_endif() }}
                {% endif %}
                {% endfor %}
                </div>

            {% if rowGroups is not empty %}
            {{ echo_endif() }}
            {% endif %}
            {% endfor %}
        </fieldset>

    {% if fieldsetGroups is not empty %}
    {{ echo_endif() }}
    {% endif %}
    {% endfor %}

    {{ echo_endblock() }}

    {{ echo_block('form_buttons') }}
        <div id="show-actions" class="form-group form-actions actions-bar">
            <div class="btn-toolbar" role="toolbar">
                {{ block("generic_actions") }}
            </div>
        </div>
    {{ echo_endblock() }}
{{ echo_endblock() }}
{% endblock %}
